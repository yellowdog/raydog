apiVersion: v1
kind: ConfigMap
metadata:
    name: ray-ray-overview
    labels:
        grafana_dashboard: "1"
data:
    ray-overview.json: >
        {"annotations":{"list":[{"builtIn":1,"datasource":{"type":"datasource","uid":"grafana"},"enable":true,"hide":true,"iconColor":"rgba(0, 211, 255, 1)","name":"Annotations & Alerts","type":"dashboard"}]},"editable":true,"fiscalYearStartMonth":0,"graphTooltip":1,"id":33,"links":[],"panels":[{"datasource":{"uid":"${datasource}"},"description":"Current number of tasks in a particular state.\n\nState: the task state, as described by rpc::TaskState proto in common.proto. Task resubmissions due to failures or object reconstruction are shown with (retry) in the label.","fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisBorderShow":false,"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":0,"barWidthFactor":0.6,"drawStyle":"line","fillOpacity":0,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"insertNulls":false,"lineInterpolation":"linear","lineWidth":1,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"never","spanNulls":false,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"min":0,"thresholds":{"mode":"absolute","steps":[{"color":"green"},{"color":"red","value":80}]},"unit":"tasks"},"overrides":[{"matcher":{"id":"byName","options":"MAX"},"properties":[{"id":"color","value":{"fixedColor":"#1F60C4","mode":"fixed"}},{"id":"custom.fillOpacity","value":0},{"id":"custom.stacking","value":{"group":"A","mode":"none"}},{"id":"custom.lineStyle","value":{"dash":[10,10],"fill":"dash"}}]},{"matcher":{"id":"byName","options":"MAX + PENDING"},"properties":[{"id":"color","value":{"fixedColor":"#777777","mode":"fixed"}},{"id":"custom.fillOpacity","value":0},{"id":"custom.stacking","value":{"group":"A","mode":"none"}},{"id":"custom.lineStyle","value":{"dash":[10,10],"fill":"dash"}}]},{"matcher":{"id":"byValue","options":{"op":"gte","reducer":"allIsZero","value":0}},"properties":[{"id":"custom.hideFrom","value":{"legend":true,"tooltip":true,"viz":false}}]},{"__systemRef":"hideSeriesFrom","matcher":{"id":"byNames","options":{"mode":"exclude","names":["FAILED","PENDING_ARGS_AVAIL","RUNNING_IN_RAY_GET","RUNNING_IN_RAY_WAIT","PENDING_ARGS_AVAIL (retry)"],"prefix":"All except:","readOnly":true}},"properties":[{"id":"custom.hideFrom","value":{"legend":false,"tooltip":false,"viz":true}}]}]},"gridPos":{"h":8,"w":12,"x":0,"y":0},"id":26,"options":{"alertThreshold":true,"legend":{"calcs":["lastNotNull"],"displayMode":"table","placement":"bottom","showLegend":true},"tooltip":{"hideZeros":false,"mode":"multi","sort":"none"}},"pluginVersion":"12.0.0","targets":[{"datasource":{"uid":"${datasource}"},"editorMode":"code","exemplar":true,"expr":"sum(max_over_time(ray_tasks{IsRetry=\"0\",State=~\"FINISHED|FAILED\",instance=~\"$Instance\",SessionName=~\"$SessionName\",ray_io_cluster=~\"$Cluster\",}[14d])) by (State) or clamp_min(sum(ray_tasks{IsRetry=\"0\",State!~\"FINISHED|FAILED\",instance=~\"$Instance\",SessionName=~\"$SessionName\",ray_io_cluster=~\"$Cluster\",}) by (State), 0)","interval":"","legendFormat":"{{State}}","queryType":"randomWalk","range":true,"refId":"A"},{"datasource":{"uid":"${datasource}"},"editorMode":"code","exemplar":true,"expr":"sum(max_over_time(ray_tasks{IsRetry!=\"0\",State=~\"FINISHED|FAILED\",instance=~\"$Instance\",SessionName=~\"$SessionName\",ray_io_cluster=~\"$Cluster\",}[14d])) by (State) or clamp_min(sum(ray_tasks{IsRetry!=\"0\",State!~\"FINISHED|FAILED\",instance=~\"$Instance\",SessionName=~\"$SessionName\",ray_io_cluster=~\"$Cluster\",}) by (State), 0)","interval":"","legendFormat":"{{State}} (retry)","queryType":"randomWalk","range":true,"refId":"B"}],"title":"Scheduler Task State","type":"timeseries"},{"datasource":{"uid":"${datasource}"},"description":"Current number of (live) tasks with a particular name. Task resubmissions due to failures or object reconstruction are shown with (retry) in the label.","fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisBorderShow":false,"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":0,"barWidthFactor":0.6,"drawStyle":"line","fillOpacity":0,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"insertNulls":false,"lineInterpolation":"linear","lineWidth":1,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"never","spanNulls":false,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"min":0,"thresholds":{"mode":"absolute","steps":[{"color":"green"},{"color":"red","value":80}]},"unit":"tasks"},"overrides":[{"matcher":{"id":"byName","options":"MAX"},"properties":[{"id":"color","value":{"fixedColor":"#1F60C4","mode":"fixed"}},{"id":"custom.fillOpacity","value":0},{"id":"custom.stacking","value":{"group":"A","mode":"none"}},{"id":"custom.lineStyle","value":{"dash":[10,10],"fill":"dash"}}]},{"matcher":{"id":"byName","options":"MAX + PENDING"},"properties":[{"id":"color","value":{"fixedColor":"#777777","mode":"fixed"}},{"id":"custom.fillOpacity","value":0},{"id":"custom.stacking","value":{"group":"A","mode":"none"}},{"id":"custom.lineStyle","value":{"dash":[10,10],"fill":"dash"}}]},{"matcher":{"id":"byValue","options":{"op":"gte","reducer":"allIsZero","value":0}},"properties":[{"id":"custom.hideFrom","value":{"legend":true,"tooltip":true,"viz":false}}]}]},"gridPos":{"h":8,"w":12,"x":12,"y":0},"id":35,"options":{"alertThreshold":true,"legend":{"calcs":["lastNotNull"],"displayMode":"table","placement":"bottom","showLegend":true},"tooltip":{"hideZeros":false,"mode":"multi","sort":"none"}},"pluginVersion":"12.0.0","targets":[{"datasource":{"uid":"${datasource}"},"exemplar":true,"expr":"clamp_min(sum(ray_tasks{IsRetry=\"0\",State!~\"FINISHED|FAILED\",instance=~\"$Instance\",SessionName=~\"$SessionName\",ray_io_cluster=~\"$Cluster\",}) by (Name), 0)","interval":"","legendFormat":"{{Name}}","queryType":"randomWalk","refId":"A"},{"datasource":{"uid":"${datasource}"},"exemplar":true,"expr":"clamp_min(sum(ray_tasks{IsRetry!=\"0\",State!~\"FINISHED|FAILED\",instance=~\"$Instance\",SessionName=~\"$SessionName\",ray_io_cluster=~\"$Cluster\",}) by (Name), 0)","interval":"","legendFormat":"{{Name}} (retry)","queryType":"randomWalk","refId":"B"}],"title":"Requested Live Tasks by Name","type":"timeseries"},{"datasource":{"uid":"${datasource}"},"description":"Current number of (running) tasks with a particular name. Task resubmissions due to failures or object reconstruction are shown with (retry) in the label.","fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisBorderShow":false,"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":0,"barWidthFactor":0.6,"drawStyle":"line","fillOpacity":0,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"insertNulls":false,"lineInterpolation":"linear","lineWidth":1,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"never","spanNulls":false,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"min":0,"thresholds":{"mode":"absolute","steps":[{"color":"green"},{"color":"red","value":80}]},"unit":"tasks"},"overrides":[{"matcher":{"id":"byName","options":"MAX"},"properties":[{"id":"color","value":{"fixedColor":"#1F60C4","mode":"fixed"}},{"id":"custom.fillOpacity","value":0},{"id":"custom.stacking","value":{"group":"A","mode":"none"}},{"id":"custom.lineStyle","value":{"dash":[10,10],"fill":"dash"}}]},{"matcher":{"id":"byName","options":"MAX + PENDING"},"properties":[{"id":"color","value":{"fixedColor":"#777777","mode":"fixed"}},{"id":"custom.fillOpacity","value":0},{"id":"custom.stacking","value":{"group":"A","mode":"none"}},{"id":"custom.lineStyle","value":{"dash":[10,10],"fill":"dash"}}]},{"matcher":{"id":"byValue","options":{"op":"gte","reducer":"allIsZero","value":0}},"properties":[{"id":"custom.hideFrom","value":{"legend":true,"tooltip":true,"viz":false}}]}]},"gridPos":{"h":8,"w":12,"x":0,"y":8},"id":38,"options":{"alertThreshold":true,"legend":{"calcs":["lastNotNull"],"displayMode":"table","placement":"bottom","showLegend":true},"tooltip":{"hideZeros":false,"mode":"multi","sort":"none"}},"pluginVersion":"12.0.0","targets":[{"datasource":{"uid":"${datasource}"},"exemplar":true,"expr":"clamp_min(sum(ray_tasks{IsRetry=\"0\",State=~\"RUNNING*\",instance=~\"$Instance\",SessionName=~\"$SessionName\",ray_io_cluster=~\"$Cluster\",}) by (Name), 0)","interval":"","legendFormat":"{{Name}}","queryType":"randomWalk","refId":"A"},{"datasource":{"uid":"${datasource}"},"exemplar":true,"expr":"clamp_min(sum(ray_tasks{IsRetry!=\"0\",State=~\"RUNNING*\",instance=~\"$Instance\",SessionName=~\"$SessionName\",ray_io_cluster=~\"$Cluster\",}) by (Name), 0)","interval":"","legendFormat":"{{Name}} (retry)","queryType":"randomWalk","refId":"B"}],"title":"Running Tasks by Name","type":"timeseries"},{"datasource":{"uid":"${datasource}"},"description":"Note: not impacted by \"Instance\" variable.\n\nCurrent number of actors in a particular state.\n\nState: the actor state, as described by rpc::ActorTableData proto in gcs.proto.","fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisBorderShow":false,"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":0,"barWidthFactor":0.6,"drawStyle":"line","fillOpacity":100,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"insertNulls":false,"lineInterpolation":"linear","lineWidth":1,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"never","spanNulls":true,"stacking":{"group":"A","mode":"normal"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"min":0,"thresholds":{"mode":"absolute","steps":[{"color":"green"},{"color":"red","value":80}]},"unit":"actors"},"overrides":[{"matcher":{"id":"byName","options":"MAX"},"properties":[{"id":"color","value":{"fixedColor":"#1F60C4","mode":"fixed"}},{"id":"custom.fillOpacity","value":0},{"id":"custom.stacking","value":{"group":"A","mode":"none"}},{"id":"custom.lineStyle","value":{"dash":[10,10],"fill":"dash"}}]},{"matcher":{"id":"byName","options":"MAX + PENDING"},"properties":[{"id":"color","value":{"fixedColor":"#777777","mode":"fixed"}},{"id":"custom.fillOpacity","value":0},{"id":"custom.stacking","value":{"group":"A","mode":"none"}},{"id":"custom.lineStyle","value":{"dash":[10,10],"fill":"dash"}}]},{"matcher":{"id":"byValue","options":{"op":"gte","reducer":"allIsZero","value":0}},"properties":[{"id":"custom.hideFrom","value":{"legend":true,"tooltip":true,"viz":false}}]}]},"gridPos":{"h":8,"w":12,"x":12,"y":8},"id":33,"options":{"alertThreshold":true,"legend":{"calcs":["lastNotNull"],"displayMode":"table","placement":"bottom","showLegend":true},"tooltip":{"hideZeros":false,"mode":"multi","sort":"none"}},"pluginVersion":"12.0.0","targets":[{"datasource":{"uid":"${datasource}"},"exemplar":true,"expr":"sum(ray_actors{Source=\"gcs\",SessionName=~\"$SessionName\",ray_io_cluster=~\"$Cluster\",}) by (State)","interval":"","legendFormat":"{{State}}","queryType":"randomWalk","refId":"A"}],"title":"Scheduler Actor State","type":"timeseries"},{"datasource":{"uid":"${datasource}"},"description":"Current number of alive actors in a particular state.\n\nState: IDLE, RUNNING_TASK, RUNNING_IN_RAY_GET, RUNNING_IN_RAY_WAIT","fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisBorderShow":false,"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":0,"barWidthFactor":0.6,"drawStyle":"line","fillOpacity":100,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"insertNulls":false,"lineInterpolation":"linear","lineWidth":1,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"never","spanNulls":true,"stacking":{"group":"A","mode":"normal"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"min":0,"thresholds":{"mode":"absolute","steps":[{"color":"green"},{"color":"red","value":80}]},"unit":"actors"},"overrides":[{"matcher":{"id":"byName","options":"MAX"},"properties":[{"id":"color","value":{"fixedColor":"#1F60C4","mode":"fixed"}},{"id":"custom.fillOpacity","value":0},{"id":"custom.stacking","value":{"group":"A","mode":"none"}},{"id":"custom.lineStyle","value":{"dash":[10,10],"fill":"dash"}}]},{"matcher":{"id":"byName","options":"MAX + PENDING"},"properties":[{"id":"color","value":{"fixedColor":"#777777","mode":"fixed"}},{"id":"custom.fillOpacity","value":0},{"id":"custom.stacking","value":{"group":"A","mode":"none"}},{"id":"custom.lineStyle","value":{"dash":[10,10],"fill":"dash"}}]},{"matcher":{"id":"byValue","options":{"op":"gte","reducer":"allIsZero","value":0}},"properties":[{"id":"custom.hideFrom","value":{"legend":true,"tooltip":true,"viz":false}}]}]},"gridPos":{"h":8,"w":12,"x":0,"y":16},"id":42,"options":{"alertThreshold":true,"legend":{"calcs":["lastNotNull"],"displayMode":"table","placement":"bottom","showLegend":true},"tooltip":{"hideZeros":false,"mode":"multi","sort":"none"}},"pluginVersion":"12.0.0","targets":[{"datasource":{"uid":"${datasource}"},"exemplar":true,"expr":"sum(ray_actors{Source=\"executor\",NodeAddress=~\"$Instance\",SessionName=~\"$SessionName\",ray_io_cluster=~\"$Cluster\",}) by (State)","interval":"","legendFormat":"{{State}}","queryType":"randomWalk","refId":"A"}],"title":"Live Actor State","type":"timeseries"},{"datasource":{"uid":"${datasource}"},"description":"Current number of alive actors with a particular name.","fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisBorderShow":false,"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":0,"barWidthFactor":0.6,"drawStyle":"line","fillOpacity":100,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"insertNulls":false,"lineInterpolation":"linear","lineWidth":1,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"never","spanNulls":true,"stacking":{"group":"A","mode":"normal"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"min":0,"thresholds":{"mode":"absolute","steps":[{"color":"green"},{"color":"red","value":80}]},"unit":"actors"},"overrides":[{"matcher":{"id":"byName","options":"MAX"},"properties":[{"id":"color","value":{"fixedColor":"#1F60C4","mode":"fixed"}},{"id":"custom.fillOpacity","value":0},{"id":"custom.stacking","value":{"group":"A","mode":"none"}},{"id":"custom.lineStyle","value":{"dash":[10,10],"fill":"dash"}}]},{"matcher":{"id":"byName","options":"MAX + PENDING"},"properties":[{"id":"color","value":{"fixedColor":"#777777","mode":"fixed"}},{"id":"custom.fillOpacity","value":0},{"id":"custom.stacking","value":{"group":"A","mode":"none"}},{"id":"custom.lineStyle","value":{"dash":[10,10],"fill":"dash"}}]},{"matcher":{"id":"byValue","options":{"op":"gte","reducer":"allIsZero","value":0}},"properties":[{"id":"custom.hideFrom","value":{"legend":true,"tooltip":true,"viz":false}}]}]},"gridPos":{"h":8,"w":12,"x":12,"y":16},"id":36,"options":{"alertThreshold":true,"legend":{"calcs":["lastNotNull"],"displayMode":"table","placement":"bottom","showLegend":true},"tooltip":{"hideZeros":false,"mode":"multi","sort":"none"}},"pluginVersion":"12.0.0","targets":[{"datasource":{"uid":"${datasource}"},"exemplar":true,"expr":"sum(ray_actors{State!=\"DEAD\",Source=\"executor\",NodeAddress=~\"$Instance\",SessionName=~\"$SessionName\",ray_io_cluster=~\"$Cluster\",}) by (Name)","interval":"","legendFormat":"{{Name}}","queryType":"randomWalk","refId":"A"}],"title":"Live Actors by Name","type":"timeseries"},{"datasource":{"uid":"${datasource}"},"description":"Logical CPU usage of Ray. The dotted line indicates the total number of CPUs. The logical CPU is allocated by `num_cpus` arguments from tasks and actors. PENDING means the number of CPUs that will be available when new nodes are up after the autoscaler scales up.\n\nNOTE: Ray's logical CPU is different from physical CPU usage. Ray's logical CPU is allocated by `num_cpus` arguments.","fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisBorderShow":false,"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":0,"barWidthFactor":0.6,"drawStyle":"line","fillOpacity":100,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"insertNulls":false,"lineInterpolation":"linear","lineWidth":1,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"never","spanNulls":true,"stacking":{"group":"A","mode":"normal"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"min":0,"thresholds":{"mode":"absolute","steps":[{"color":"green"},{"color":"red","value":80}]},"unit":"cores"},"overrides":[{"matcher":{"id":"byName","options":"MAX"},"properties":[{"id":"color","value":{"fixedColor":"#1F60C4","mode":"fixed"}},{"id":"custom.fillOpacity","value":0},{"id":"custom.stacking","value":{"group":"A","mode":"none"}},{"id":"custom.lineStyle","value":{"dash":[10,10],"fill":"dash"}}]},{"matcher":{"id":"byName","options":"MAX + PENDING"},"properties":[{"id":"color","value":{"fixedColor":"#777777","mode":"fixed"}},{"id":"custom.fillOpacity","value":0},{"id":"custom.stacking","value":{"group":"A","mode":"none"}},{"id":"custom.lineStyle","value":{"dash":[10,10],"fill":"dash"}}]},{"matcher":{"id":"byValue","options":{"op":"gte","reducer":"allIsZero","value":0}},"properties":[{"id":"custom.hideFrom","value":{"legend":true,"tooltip":true,"viz":false}}]}]},"gridPos":{"h":8,"w":12,"x":0,"y":24},"id":27,"options":{"alertThreshold":true,"legend":{"calcs":["lastNotNull"],"displayMode":"table","placement":"bottom","showLegend":true},"tooltip":{"hideZeros":false,"mode":"multi","sort":"none"}},"pluginVersion":"12.0.0","targets":[{"datasource":{"uid":"${datasource}"},"editorMode":"code","exemplar":true,"expr":"sum(ray_resources{Name=\"CPU\",SessionName=~\"$SessionName\",ray_io_cluster=~\"$Cluster\",}) by (State)","interval":"","legendFormat":"{{ State }}","queryType":"randomWalk","range":true,"refId":"A"}],"title":"Scheduler CPUs","type":"timeseries"},{"datasource":{"uid":"${datasource}"},"description":"Object store memory usage by location. The dotted line indicates the object store memory capacity.\n\nLocation: where the memory was allocated, which is MMAP_SHM or MMAP_DISK to indicate memory-mapped page, SPILLED to indicate spillage to disk, and WORKER_HEAP for objects small enough to be inlined in worker memory. Refer to metric_defs.cc for more information.","fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisBorderShow":false,"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":0,"barWidthFactor":0.6,"drawStyle":"line","fillOpacity":100,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"insertNulls":false,"lineInterpolation":"linear","lineWidth":1,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"never","spanNulls":true,"stacking":{"group":"A","mode":"normal"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"min":0,"thresholds":{"mode":"absolute","steps":[{"color":"green"},{"color":"red","value":80}]},"unit":"bytes"},"overrides":[{"matcher":{"id":"byName","options":"MAX"},"properties":[{"id":"color","value":{"fixedColor":"#1F60C4","mode":"fixed"}},{"id":"custom.fillOpacity","value":0},{"id":"custom.stacking","value":{"group":"A","mode":"none"}},{"id":"custom.lineStyle","value":{"dash":[10,10],"fill":"dash"}}]},{"matcher":{"id":"byName","options":"MAX + PENDING"},"properties":[{"id":"color","value":{"fixedColor":"#777777","mode":"fixed"}},{"id":"custom.fillOpacity","value":0},{"id":"custom.stacking","value":{"group":"A","mode":"none"}},{"id":"custom.lineStyle","value":{"dash":[10,10],"fill":"dash"}}]},{"matcher":{"id":"byValue","options":{"op":"gte","reducer":"allIsZero","value":0}},"properties":[{"id":"custom.hideFrom","value":{"legend":true,"tooltip":true,"viz":false}}]}]},"gridPos":{"h":8,"w":12,"x":12,"y":24},"id":29,"options":{"alertThreshold":true,"legend":{"calcs":["lastNotNull"],"displayMode":"table","placement":"bottom","showLegend":true},"tooltip":{"hideZeros":false,"mode":"multi","sort":"none"}},"pluginVersion":"12.0.0","targets":[{"datasource":{"uid":"${datasource}"},"exemplar":true,"expr":"sum(ray_object_store_memory{instance=~\"$Instance\",SessionName=~\"$SessionName\",ray_io_cluster=~\"$Cluster\",}) by (Location)","interval":"","legendFormat":"{{Location}}","queryType":"randomWalk","refId":"A"},{"datasource":{"uid":"${datasource}"},"exemplar":true,"expr":"sum(ray_resources{Name=\"object_store_memory\",instance=~\"$Instance\",SessionName=~\"$SessionName\",ray_io_cluster=~\"$Cluster\",})","interval":"","legendFormat":"MAX","queryType":"randomWalk","refId":"B"}],"title":"Object Store Memory","type":"timeseries"},{"datasource":{"uid":"${datasource}"},"description":"","fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisBorderShow":false,"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":0,"barWidthFactor":0.6,"drawStyle":"line","fillOpacity":100,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"insertNulls":false,"lineInterpolation":"linear","lineWidth":1,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"never","spanNulls":true,"stacking":{"group":"A","mode":"normal"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"min":0,"thresholds":{"mode":"absolute","steps":[{"color":"green"},{"color":"red","value":80}]},"unit":"cores"},"overrides":[{"matcher":{"id":"byName","options":"MAX"},"properties":[{"id":"color","value":{"fixedColor":"#1F60C4","mode":"fixed"}},{"id":"custom.fillOpacity","value":0},{"id":"custom.stacking","value":{"group":"A","mode":"none"}},{"id":"custom.lineStyle","value":{"dash":[10,10],"fill":"dash"}}]},{"matcher":{"id":"byName","options":"MAX + PENDING"},"properties":[{"id":"color","value":{"fixedColor":"#777777","mode":"fixed"}},{"id":"custom.fillOpacity","value":0},{"id":"custom.stacking","value":{"group":"A","mode":"none"}},{"id":"custom.lineStyle","value":{"dash":[10,10],"fill":"dash"}}]},{"matcher":{"id":"byValue","options":{"op":"gte","reducer":"allIsZero","value":0}},"properties":[{"id":"custom.hideFrom","value":{"legend":true,"tooltip":true,"viz":false}}]}]},"gridPos":{"h":8,"w":12,"x":0,"y":32},"id":2,"options":{"alertThreshold":true,"legend":{"calcs":["lastNotNull"],"displayMode":"table","placement":"bottom","showLegend":true},"tooltip":{"hideZeros":false,"mode":"multi","sort":"none"}},"pluginVersion":"12.0.0","targets":[{"datasource":{"uid":"${datasource}"},"exemplar":true,"expr":"sum(ray_node_cpu_utilization{instance=~\"$Instance\", IsHeadNode=\"false\", SessionName=~\"$SessionName\",ray_io_cluster=~\"$Cluster\",} * ray_node_cpu_count{instance=~\"$Instance\",SessionName=~\"$SessionName\",ray_io_cluster=~\"$Cluster\",} / 100) by (instance)","interval":"","legendFormat":"CPU Usage: {{instance}}","queryType":"randomWalk","refId":"A"},{"datasource":{"uid":"${datasource}"},"exemplar":true,"expr":"sum(ray_node_cpu_utilization{instance=~\"$Instance\", IsHeadNode=\"true\", SessionName=~\"$SessionName\",ray_io_cluster=~\"$Cluster\",} * ray_node_cpu_count{instance=~\"$Instance\",SessionName=~\"$SessionName\",ray_io_cluster=~\"$Cluster\",} / 100) by (instance)","interval":"","legendFormat":"CPU Usage: {{instance}} (head)","queryType":"randomWalk","refId":"B"},{"datasource":{"uid":"${datasource}"},"exemplar":true,"expr":"sum(ray_node_cpu_count{instance=~\"$Instance\",SessionName=~\"$SessionName\",ray_io_cluster=~\"$Cluster\",})","interval":"","legendFormat":"MAX","queryType":"randomWalk","refId":"C"}],"title":"Node CPU (hardware utilization)","type":"timeseries"},{"datasource":{"uid":"${datasource}"},"description":"Node's physical (hardware) GPU usage. The dotted line means the total number of hardware GPUs from the cluster. ","fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisBorderShow":false,"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":0,"barWidthFactor":0.6,"drawStyle":"line","fillOpacity":100,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"insertNulls":false,"lineInterpolation":"linear","lineWidth":1,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"never","spanNulls":true,"stacking":{"group":"A","mode":"normal"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"min":0,"thresholds":{"mode":"absolute","steps":[{"color":"green"},{"color":"red","value":80}]},"unit":"GPUs"},"overrides":[{"matcher":{"id":"byName","options":"MAX"},"properties":[{"id":"color","value":{"fixedColor":"#1F60C4","mode":"fixed"}},{"id":"custom.fillOpacity","value":0},{"id":"custom.stacking","value":{"group":"A","mode":"none"}},{"id":"custom.lineStyle","value":{"dash":[10,10],"fill":"dash"}}]},{"matcher":{"id":"byName","options":"MAX + PENDING"},"properties":[{"id":"color","value":{"fixedColor":"#777777","mode":"fixed"}},{"id":"custom.fillOpacity","value":0},{"id":"custom.stacking","value":{"group":"A","mode":"none"}},{"id":"custom.lineStyle","value":{"dash":[10,10],"fill":"dash"}}]},{"matcher":{"id":"byValue","options":{"op":"gte","reducer":"allIsZero","value":0}},"properties":[{"id":"custom.hideFrom","value":{"legend":true,"tooltip":true,"viz":false}}]}]},"gridPos":{"h":8,"w":12,"x":12,"y":32},"id":8,"options":{"alertThreshold":true,"legend":{"calcs":["lastNotNull"],"displayMode":"table","placement":"bottom","showLegend":true},"tooltip":{"hideZeros":false,"mode":"multi","sort":"none"}},"pluginVersion":"12.0.0","targets":[{"datasource":{"uid":"${datasource}"},"exemplar":true,"expr":"sum(ray_node_gpus_utilization{instance=~\"$Instance\", IsHeadNode=\"false\", SessionName=~\"$SessionName\",ray_io_cluster=~\"$Cluster\",} / 100) by (instance, GpuIndex, GpuDeviceName)","interval":"","legendFormat":"GPU Usage: {{instance}}, gpu.{{GpuIndex}}, {{GpuDeviceName}}","queryType":"randomWalk","refId":"A"},{"datasource":{"uid":"${datasource}"},"exemplar":true,"expr":"sum(ray_node_gpus_utilization{instance=~\"$Instance\", IsHeadNode=\"true\", SessionName=~\"$SessionName\",ray_io_cluster=~\"$Cluster\",} / 100) by (instance, GpuIndex, GpuDeviceName)","interval":"","legendFormat":"GPU Usage: {{instance}} (head), gpu.{{GpuIndex}}, {{GpuDeviceName}}","queryType":"randomWalk","refId":"B"},{"datasource":{"uid":"${datasource}"},"exemplar":true,"expr":"sum(ray_node_gpus_available{instance=~\"$Instance\",SessionName=~\"$SessionName\",ray_io_cluster=~\"$Cluster\",})","interval":"","legendFormat":"MAX","queryType":"randomWalk","refId":"C"}],"title":"Node GPU (hardware utilization)","type":"timeseries"},{"datasource":{"uid":"${datasource}"},"description":"Node's physical (hardware) disk usage. The dotted line means the total amount of disk space from the cluster.\n\nNOTE: When Ray is deployed within a container, this shows the disk usage from the host machine. ","fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisBorderShow":false,"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":0,"barWidthFactor":0.6,"drawStyle":"line","fillOpacity":100,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"insertNulls":false,"lineInterpolation":"linear","lineWidth":1,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"never","spanNulls":true,"stacking":{"group":"A","mode":"normal"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"min":0,"thresholds":{"mode":"absolute","steps":[{"color":"green"},{"color":"red","value":80}]},"unit":"bytes"},"overrides":[{"matcher":{"id":"byName","options":"MAX"},"properties":[{"id":"color","value":{"fixedColor":"#1F60C4","mode":"fixed"}},{"id":"custom.fillOpacity","value":0},{"id":"custom.stacking","value":{"group":"A","mode":"none"}},{"id":"custom.lineStyle","value":{"dash":[10,10],"fill":"dash"}}]},{"matcher":{"id":"byName","options":"MAX + PENDING"},"properties":[{"id":"color","value":{"fixedColor":"#777777","mode":"fixed"}},{"id":"custom.fillOpacity","value":0},{"id":"custom.stacking","value":{"group":"A","mode":"none"}},{"id":"custom.lineStyle","value":{"dash":[10,10],"fill":"dash"}}]},{"matcher":{"id":"byValue","options":{"op":"gte","reducer":"allIsZero","value":0}},"properties":[{"id":"custom.hideFrom","value":{"legend":true,"tooltip":true,"viz":false}}]}]},"gridPos":{"h":8,"w":12,"x":0,"y":40},"id":6,"options":{"alertThreshold":true,"legend":{"calcs":["lastNotNull"],"displayMode":"table","placement":"bottom","showLegend":true},"tooltip":{"hideZeros":false,"mode":"multi","sort":"none"}},"pluginVersion":"12.0.0","targets":[{"datasource":{"uid":"${datasource}"},"exemplar":true,"expr":"sum(ray_node_disk_usage{instance=~\"$Instance\", IsHeadNode=\"false\", SessionName=~\"$SessionName\",ray_io_cluster=~\"$Cluster\",}) by (instance)","interval":"","legendFormat":"Disk Used: {{instance}}","queryType":"randomWalk","refId":"A"},{"datasource":{"uid":"${datasource}"},"exemplar":true,"expr":"sum(ray_node_disk_usage{instance=~\"$Instance\", IsHeadNode=\"true\", SessionName=~\"$SessionName\",ray_io_cluster=~\"$Cluster\",}) by (instance)","interval":"","legendFormat":"Disk Used: {{instance}} (head)","queryType":"randomWalk","refId":"B"},{"datasource":{"uid":"${datasource}"},"exemplar":true,"expr":"sum(ray_node_disk_free{instance=~\"$Instance\",SessionName=~\"$SessionName\",ray_io_cluster=~\"$Cluster\",}) + sum(ray_node_disk_usage{instance=~\"$Instance\",SessionName=~\"$SessionName\",ray_io_cluster=~\"$Cluster\",})","interval":"","legendFormat":"MAX","queryType":"randomWalk","refId":"C"}],"title":"Node Disk","type":"timeseries"},{"datasource":{"uid":"${datasource}"},"description":"Disk IO sum","fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisBorderShow":false,"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":0,"barWidthFactor":0.6,"drawStyle":"line","fillOpacity":100,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"insertNulls":false,"lineInterpolation":"linear","lineWidth":1,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"never","spanNulls":true,"stacking":{"group":"A","mode":"normal"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"min":0,"thresholds":{"mode":"absolute","steps":[{"color":"green"},{"color":"red","value":80}]},"unit":"Bps"},"overrides":[{"matcher":{"id":"byName","options":"MAX"},"properties":[{"id":"color","value":{"fixedColor":"#1F60C4","mode":"fixed"}},{"id":"custom.fillOpacity","value":0},{"id":"custom.stacking","value":{"group":"A","mode":"none"}},{"id":"custom.lineStyle","value":{"dash":[10,10],"fill":"dash"}}]},{"matcher":{"id":"byName","options":"MAX + PENDING"},"properties":[{"id":"color","value":{"fixedColor":"#777777","mode":"fixed"}},{"id":"custom.fillOpacity","value":0},{"id":"custom.stacking","value":{"group":"A","mode":"none"}},{"id":"custom.lineStyle","value":{"dash":[10,10],"fill":"dash"}}]},{"matcher":{"id":"byValue","options":{"op":"gte","reducer":"allIsZero","value":0}},"properties":[{"id":"custom.hideFrom","value":{"legend":true,"tooltip":true,"viz":false}}]}]},"gridPos":{"h":8,"w":12,"x":12,"y":40},"id":32,"options":{"alertThreshold":true,"legend":{"calcs":["lastNotNull"],"displayMode":"table","placement":"bottom","showLegend":true},"tooltip":{"hideZeros":false,"mode":"multi","sort":"none"}},"pluginVersion":"12.0.0","targets":[{"datasource":{"uid":"${datasource}"},"editorMode":"code","exemplar":true,"expr":"sum(ray_node_disk_io_write_speed{instance=~\"$Instance\", IsHeadNode=\"false\", SessionName=~\"$SessionName\",ray_io_cluster=~\"$Cluster\",})","interval":"","legendFormat":"Write","queryType":"randomWalk","range":true,"refId":"A"},{"datasource":{"uid":"${datasource}"},"editorMode":"code","exemplar":true,"expr":"sum(ray_node_disk_io_write_speed{instance=~\"$Instance\", IsHeadNode=\"true\", SessionName=~\"$SessionName\",ray_io_cluster=~\"$Cluster\",})","interval":"","legendFormat":"Write (head)","queryType":"randomWalk","range":true,"refId":"B"},{"datasource":{"uid":"${datasource}"},"editorMode":"code","exemplar":true,"expr":"sum(ray_node_disk_io_read_speed{instance=~\"$Instance\", IsHeadNode=\"false\", SessionName=~\"$SessionName\",ray_io_cluster=~\"$Cluster\",})","interval":"","legendFormat":"Read","queryType":"randomWalk","range":true,"refId":"C"},{"datasource":{"uid":"${datasource}"},"editorMode":"code","exemplar":true,"expr":"sum(ray_node_disk_io_read_speed{instance=~\"$Instance\", IsHeadNode=\"true\", SessionName=~\"$SessionName\",ray_io_cluster=~\"$Cluster\",})","interval":"","legendFormat":"Read (head)","queryType":"randomWalk","range":true,"refId":"D"}],"title":"Cluster Disk IO (Sum)","type":"timeseries"},{"datasource":{"uid":"${datasource}"},"description":"The physical (hardware) memory usage for each node. The dotted line means the total amount of memory from the cluster. Node memory is a sum of object store memory (shared memory) and heap memory.\n\nNote: If Ray is deployed within a container, the total memory could be lower than the host machine because Ray may reserve some additional memory space outside the container.","fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisBorderShow":false,"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":0,"barWidthFactor":0.6,"drawStyle":"line","fillOpacity":100,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"insertNulls":false,"lineInterpolation":"linear","lineWidth":1,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"never","spanNulls":true,"stacking":{"group":"A","mode":"normal"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"min":0,"thresholds":{"mode":"absolute","steps":[{"color":"green"},{"color":"red","value":80}]},"unit":"bytes"},"overrides":[{"matcher":{"id":"byName","options":"MAX"},"properties":[{"id":"color","value":{"fixedColor":"#1F60C4","mode":"fixed"}},{"id":"custom.fillOpacity","value":0},{"id":"custom.stacking","value":{"group":"A","mode":"none"}},{"id":"custom.lineStyle","value":{"dash":[10,10],"fill":"dash"}}]},{"matcher":{"id":"byName","options":"MAX + PENDING"},"properties":[{"id":"color","value":{"fixedColor":"#777777","mode":"fixed"}},{"id":"custom.fillOpacity","value":0},{"id":"custom.stacking","value":{"group":"A","mode":"none"}},{"id":"custom.lineStyle","value":{"dash":[10,10],"fill":"dash"}}]},{"matcher":{"id":"byValue","options":{"op":"gte","reducer":"allIsZero","value":0}},"properties":[{"id":"custom.hideFrom","value":{"legend":true,"tooltip":true,"viz":false}}]}]},"gridPos":{"h":8,"w":12,"x":0,"y":48},"id":4,"options":{"alertThreshold":true,"legend":{"calcs":["lastNotNull"],"displayMode":"table","placement":"bottom","showLegend":true},"tooltip":{"hideZeros":false,"mode":"multi","sort":"none"}},"pluginVersion":"12.0.0","targets":[{"datasource":{"uid":"${datasource}"},"editorMode":"code","exemplar":true,"expr":"sum(ray_node_mem_used{instance=~\"$Instance\", IsHeadNode=\"false\", SessionName=~\"$SessionName\",ray_io_cluster=~\"$Cluster\",})","interval":"","legendFormat":"Memory Used","queryType":"randomWalk","range":true,"refId":"A"},{"datasource":{"uid":"${datasource}"},"editorMode":"code","exemplar":true,"expr":"sum(ray_node_mem_used{instance=~\"$Instance\", IsHeadNode=\"true\", SessionName=~\"$SessionName\",ray_io_cluster=~\"$Cluster\",})","interval":"","legendFormat":"Memory Used (head)","queryType":"randomWalk","range":true,"refId":"B"},{"datasource":{"uid":"${datasource}"},"exemplar":true,"expr":"sum(ray_node_mem_total{instance=~\"$Instance\",SessionName=~\"$SessionName\",ray_io_cluster=~\"$Cluster\",})","interval":"","legendFormat":"MAX","queryType":"randomWalk","refId":"C"}],"title":"Sum of Node Memory (heap + object store)","type":"timeseries"},{"datasource":{"uid":"${datasource}"},"description":"The percentage of physical (hardware) memory usage for each node.","fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisBorderShow":false,"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":0,"barWidthFactor":0.6,"drawStyle":"line","fillOpacity":0,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"insertNulls":false,"lineInterpolation":"linear","lineWidth":1,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"never","spanNulls":false,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"min":0,"thresholds":{"mode":"absolute","steps":[{"color":"green"},{"color":"red","value":80}]},"unit":"bytes"},"overrides":[{"matcher":{"id":"byName","options":"MAX"},"properties":[{"id":"color","value":{"fixedColor":"#1F60C4","mode":"fixed"}},{"id":"custom.fillOpacity","value":0},{"id":"custom.stacking","value":{"group":"A","mode":"none"}},{"id":"custom.lineStyle","value":{"dash":[10,10],"fill":"dash"}}]},{"matcher":{"id":"byName","options":"MAX + PENDING"},"properties":[{"id":"color","value":{"fixedColor":"#777777","mode":"fixed"}},{"id":"custom.fillOpacity","value":0},{"id":"custom.stacking","value":{"group":"A","mode":"none"}},{"id":"custom.lineStyle","value":{"dash":[10,10],"fill":"dash"}}]},{"matcher":{"id":"byValue","options":{"op":"gte","reducer":"allIsZero","value":0}},"properties":[{"id":"custom.hideFrom","value":{"legend":true,"tooltip":true,"viz":false}}]}]},"gridPos":{"h":8,"w":12,"x":12,"y":48},"id":48,"options":{"alertThreshold":true,"legend":{"calcs":["lastNotNull"],"displayMode":"table","placement":"bottom","showLegend":true},"tooltip":{"hideZeros":false,"mode":"multi","sort":"none"}},"pluginVersion":"12.0.0","targets":[{"datasource":{"uid":"${datasource}"},"editorMode":"code","exemplar":true,"expr":"sum(ray_node_mem_used{instance=~\"$Instance\", IsHeadNode=\"false\", SessionName=~\"$SessionName\",ray_io_cluster=~\"$Cluster\",})","interval":"","legendFormat":"Memory Used","queryType":"randomWalk","range":true,"refId":"A"},{"datasource":{"uid":"${datasource}"},"editorMode":"code","exemplar":true,"expr":"sum(ray_node_mem_used{instance=~\"$Instance\", IsHeadNode=\"true\", SessionName=~\"$SessionName\",ray_io_cluster=~\"$Cluster\",})","interval":"","legendFormat":"Memory Used (head)","queryType":"randomWalk","range":true,"refId":"B"}],"title":"Sum of Node Memory Percentage (heap + object store)","type":"timeseries"},{"datasource":{"uid":"${datasource}"},"description":"The number of tasks and actors killed by the Ray Out of Memory killer due to high memory pressure. Metrics are broken down by IP and the name. https://docs.ray.io/en/master/ray-core/scheduling/ray-oom-prevention.html.","fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisBorderShow":false,"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":0,"barWidthFactor":0.6,"drawStyle":"line","fillOpacity":100,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"insertNulls":false,"lineInterpolation":"linear","lineWidth":1,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"never","spanNulls":true,"stacking":{"group":"A","mode":"normal"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"min":0,"thresholds":{"mode":"absolute","steps":[{"color":"green"},{"color":"red","value":80}]},"unit":"failures"},"overrides":[{"matcher":{"id":"byName","options":"MAX"},"properties":[{"id":"color","value":{"fixedColor":"#1F60C4","mode":"fixed"}},{"id":"custom.fillOpacity","value":0},{"id":"custom.stacking","value":{"group":"A","mode":"none"}},{"id":"custom.lineStyle","value":{"dash":[10,10],"fill":"dash"}}]},{"matcher":{"id":"byName","options":"MAX + PENDING"},"properties":[{"id":"color","value":{"fixedColor":"#777777","mode":"fixed"}},{"id":"custom.fillOpacity","value":0},{"id":"custom.stacking","value":{"group":"A","mode":"none"}},{"id":"custom.lineStyle","value":{"dash":[10,10],"fill":"dash"}}]},{"matcher":{"id":"byValue","options":{"op":"gte","reducer":"allIsZero","value":0}},"properties":[{"id":"custom.hideFrom","value":{"legend":true,"tooltip":true,"viz":false}}]}]},"gridPos":{"h":8,"w":12,"x":0,"y":56},"id":44,"options":{"alertThreshold":true,"legend":{"calcs":["lastNotNull"],"displayMode":"table","placement":"bottom","showLegend":true},"tooltip":{"hideZeros":false,"mode":"multi","sort":"none"}},"pluginVersion":"12.0.0","targets":[{"datasource":{"uid":"${datasource}"},"exemplar":true,"expr":"sum(ray_memory_manager_worker_eviction_total{instance=~\"$Instance\",SessionName=~\"$SessionName\",ray_io_cluster=~\"$Cluster\",}) by (Name, instance)","interval":"","legendFormat":"OOM Killed: {{Name}}, {{instance}}","queryType":"randomWalk","refId":"A"}],"title":"Node Out of Memory Failures by Name","type":"timeseries"},{"datasource":{"uid":"${datasource}"},"description":"The physical (hardware) memory usage across the cluster, broken down by component. This reports the summed RSS-SHM per Ray component, which corresponds to an approximate memory usage per proc. Ray components consist of system components (e.g., raylet, gcs, dashboard, or agent) and the process (that contains method names) names of running tasks/actors.","fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisBorderShow":false,"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":0,"barWidthFactor":0.6,"drawStyle":"line","fillOpacity":100,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"insertNulls":false,"lineInterpolation":"linear","lineWidth":1,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"never","spanNulls":true,"stacking":{"group":"A","mode":"normal"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"min":0,"thresholds":{"mode":"absolute","steps":[{"color":"green"},{"color":"red","value":80}]},"unit":"bytes"},"overrides":[{"matcher":{"id":"byName","options":"MAX"},"properties":[{"id":"color","value":{"fixedColor":"#1F60C4","mode":"fixed"}},{"id":"custom.fillOpacity","value":0},{"id":"custom.stacking","value":{"group":"A","mode":"none"}},{"id":"custom.lineStyle","value":{"dash":[10,10],"fill":"dash"}}]},{"matcher":{"id":"byName","options":"MAX + PENDING"},"properties":[{"id":"color","value":{"fixedColor":"#777777","mode":"fixed"}},{"id":"custom.fillOpacity","value":0},{"id":"custom.stacking","value":{"group":"A","mode":"none"}},{"id":"custom.lineStyle","value":{"dash":[10,10],"fill":"dash"}}]},{"matcher":{"id":"byValue","options":{"op":"gte","reducer":"allIsZero","value":0}},"properties":[{"id":"custom.hideFrom","value":{"legend":true,"tooltip":true,"viz":false}}]}]},"gridPos":{"h":8,"w":12,"x":12,"y":56},"id":34,"options":{"alertThreshold":true,"legend":{"calcs":["lastNotNull"],"displayMode":"table","placement":"bottom","showLegend":true},"tooltip":{"hideZeros":false,"mode":"multi","sort":"none"}},"pluginVersion":"12.0.0","targets":[{"datasource":{"uid":"${datasource}"},"exemplar":true,"expr":"(sum(ray_component_rss_mb{instance=~\"$Instance\",SessionName=~\"$SessionName\",ray_io_cluster=~\"$Cluster\",} * 1e6) by (Component)) - (sum(ray_component_mem_shared_bytes{instance=~\"$Instance\",SessionName=~\"$SessionName\",ray_io_cluster=~\"$Cluster\",}) by (Component))","interval":"","legendFormat":"{{Component}}","queryType":"randomWalk","refId":"A"},{"datasource":{"uid":"${datasource}"},"exemplar":true,"expr":"sum(ray_node_mem_shared_bytes{instance=~\"$Instance\",SessionName=~\"$SessionName\",ray_io_cluster=~\"$Cluster\",})","interval":"","legendFormat":"shared_memory","queryType":"randomWalk","refId":"B"},{"datasource":{"uid":"${datasource}"},"exemplar":true,"expr":"sum(ray_node_mem_total{instance=~\"$Instance\",SessionName=~\"$SessionName\",ray_io_cluster=~\"$Cluster\",})","interval":"","legendFormat":"MAX","queryType":"randomWalk","refId":"C"}],"title":"Node Memory by Component","type":"timeseries"},{"datasource":{"uid":"${datasource}"},"description":"The physical (hardware) CPU usage across the cluster, broken down by component. This reports the summed CPU usage per Ray component. Ray components consist of system components (e.g., raylet, gcs, dashboard, or agent) and the process (that contains method names) names of running tasks/actors.","fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisBorderShow":false,"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":0,"barWidthFactor":0.6,"drawStyle":"line","fillOpacity":100,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"insertNulls":false,"lineInterpolation":"linear","lineWidth":1,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"never","spanNulls":true,"stacking":{"group":"A","mode":"normal"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"min":0,"thresholds":{"mode":"absolute","steps":[{"color":"green"},{"color":"red","value":80}]},"unit":"cores"},"overrides":[{"matcher":{"id":"byName","options":"MAX"},"properties":[{"id":"color","value":{"fixedColor":"#1F60C4","mode":"fixed"}},{"id":"custom.fillOpacity","value":0},{"id":"custom.stacking","value":{"group":"A","mode":"none"}},{"id":"custom.lineStyle","value":{"dash":[10,10],"fill":"dash"}}]},{"matcher":{"id":"byName","options":"MAX + PENDING"},"properties":[{"id":"color","value":{"fixedColor":"#777777","mode":"fixed"}},{"id":"custom.fillOpacity","value":0},{"id":"custom.stacking","value":{"group":"A","mode":"none"}},{"id":"custom.lineStyle","value":{"dash":[10,10],"fill":"dash"}}]},{"matcher":{"id":"byValue","options":{"op":"gte","reducer":"allIsZero","value":0}},"properties":[{"id":"custom.hideFrom","value":{"legend":true,"tooltip":true,"viz":false}}]}]},"gridPos":{"h":8,"w":12,"x":0,"y":64},"id":37,"options":{"alertThreshold":true,"legend":{"calcs":["lastNotNull"],"displayMode":"table","placement":"bottom","showLegend":true},"tooltip":{"hideZeros":false,"mode":"multi","sort":"none"}},"pluginVersion":"12.0.0","targets":[{"datasource":{"uid":"${datasource}"},"exemplar":true,"expr":"sum(ray_component_cpu_percentage{instance=~\"$Instance\",SessionName=~\"$SessionName\",ray_io_cluster=~\"$Cluster\",}) by (Component) / 100","interval":"","legendFormat":"{{Component}}","queryType":"randomWalk","refId":"A"},{"datasource":{"uid":"${datasource}"},"exemplar":true,"expr":"sum(ray_node_cpu_count{instance=~\"$Instance\",SessionName=~\"$SessionName\",ray_io_cluster=~\"$Cluster\",})","interval":"","legendFormat":"MAX","queryType":"randomWalk","refId":"B"}],"title":"Node CPU by Component","type":"timeseries"},{"datasource":{"uid":"${datasource}"},"description":"The physical (hardware) GPU memory usage for each node. The dotted line means the total amount of GPU memory from the cluster.","fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisBorderShow":false,"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":0,"barWidthFactor":0.6,"drawStyle":"line","fillOpacity":100,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"insertNulls":false,"lineInterpolation":"linear","lineWidth":1,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"never","spanNulls":true,"stacking":{"group":"A","mode":"normal"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"min":0,"thresholds":{"mode":"absolute","steps":[{"color":"green"},{"color":"red","value":80}]},"unit":"bytes"},"overrides":[{"matcher":{"id":"byName","options":"MAX"},"properties":[{"id":"color","value":{"fixedColor":"#1F60C4","mode":"fixed"}},{"id":"custom.fillOpacity","value":0},{"id":"custom.stacking","value":{"group":"A","mode":"none"}},{"id":"custom.lineStyle","value":{"dash":[10,10],"fill":"dash"}}]},{"matcher":{"id":"byName","options":"MAX + PENDING"},"properties":[{"id":"color","value":{"fixedColor":"#777777","mode":"fixed"}},{"id":"custom.fillOpacity","value":0},{"id":"custom.stacking","value":{"group":"A","mode":"none"}},{"id":"custom.lineStyle","value":{"dash":[10,10],"fill":"dash"}}]},{"matcher":{"id":"byValue","options":{"op":"gte","reducer":"allIsZero","value":0}},"properties":[{"id":"custom.hideFrom","value":{"legend":true,"tooltip":true,"viz":false}}]}]},"gridPos":{"h":8,"w":12,"x":12,"y":64},"id":18,"options":{"alertThreshold":true,"legend":{"calcs":["lastNotNull"],"displayMode":"table","placement":"bottom","showLegend":true},"tooltip":{"hideZeros":false,"mode":"multi","sort":"none"}},"pluginVersion":"12.0.0","targets":[{"datasource":{"uid":"${datasource}"},"exemplar":true,"expr":"sum(ray_node_gram_used{instance=~\"$Instance\",SessionName=~\"$SessionName\",ray_io_cluster=~\"$Cluster\",} * 1024 * 1024) by (instance, GpuIndex, GpuDeviceName)","interval":"","legendFormat":"Used GRAM: {{instance}}, gpu.{{GpuIndex}}, {{GpuDeviceName}}","queryType":"randomWalk","refId":"A"},{"datasource":{"uid":"${datasource}"},"exemplar":true,"expr":"(sum(ray_node_gram_available{instance=~\"$Instance\",SessionName=~\"$SessionName\",ray_io_cluster=~\"$Cluster\",}) + sum(ray_node_gram_used{instance=~\"$Instance\",SessionName=~\"$SessionName\",ray_io_cluster=~\"$Cluster\",})) * 1024 * 1024","interval":"","legendFormat":"MAX","queryType":"randomWalk","refId":"B"}],"title":"Node GPU Memory (GRAM)","type":"timeseries"},{"datasource":{"uid":"${datasource}"},"description":"Network speed per node","fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisBorderShow":false,"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":0,"barWidthFactor":0.6,"drawStyle":"line","fillOpacity":100,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"insertNulls":false,"lineInterpolation":"linear","lineWidth":1,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"never","spanNulls":true,"stacking":{"group":"A","mode":"normal"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"min":0,"thresholds":{"mode":"absolute","steps":[{"color":"green"},{"color":"red","value":80}]},"unit":"Bps"},"overrides":[{"matcher":{"id":"byName","options":"MAX"},"properties":[{"id":"color","value":{"fixedColor":"#1F60C4","mode":"fixed"}},{"id":"custom.fillOpacity","value":0},{"id":"custom.stacking","value":{"group":"A","mode":"none"}},{"id":"custom.lineStyle","value":{"dash":[10,10],"fill":"dash"}}]},{"matcher":{"id":"byName","options":"MAX + PENDING"},"properties":[{"id":"color","value":{"fixedColor":"#777777","mode":"fixed"}},{"id":"custom.fillOpacity","value":0},{"id":"custom.stacking","value":{"group":"A","mode":"none"}},{"id":"custom.lineStyle","value":{"dash":[10,10],"fill":"dash"}}]},{"matcher":{"id":"byValue","options":{"op":"gte","reducer":"allIsZero","value":0}},"properties":[{"id":"custom.hideFrom","value":{"legend":true,"tooltip":true,"viz":false}}]}]},"gridPos":{"h":8,"w":12,"x":0,"y":72},"id":20,"options":{"alertThreshold":true,"legend":{"calcs":["lastNotNull"],"displayMode":"table","placement":"bottom","showLegend":true},"tooltip":{"hideZeros":false,"mode":"multi","sort":"none"}},"pluginVersion":"12.0.0","targets":[{"datasource":{"uid":"${datasource}"},"editorMode":"code","exemplar":true,"expr":"sum(ray_node_network_receive_speed{instance=~\"$Instance\",SessionName=~\"$SessionName\",ray_io_cluster=~\"$Cluster\",})","interval":"","legendFormat":"Recv","queryType":"randomWalk","range":true,"refId":"A"},{"datasource":{"uid":"${datasource}"},"editorMode":"code","exemplar":true,"expr":"sum(ray_node_network_send_speed{instance=~\"$Instance\",SessionName=~\"$SessionName\",ray_io_cluster=~\"$Cluster\",})","interval":"","legendFormat":"Send","queryType":"randomWalk","range":true,"refId":"B"}],"title":"Node Network","type":"timeseries"},{"datasource":{"uid":"${datasource}"},"description":"Note: not impacted by \"Instance\" variable.\n\nA total number of active failed, and pending nodes from the cluster. \n\nACTIVE: A node is alive and available.\n\nFAILED: A node is dead and not available. The node is considered dead when the raylet process on the node is terminated. The node will get into the failed state if it cannot be provided (e.g., there's no available node from the cloud provider) or failed to setup (e.g., setup_commands have errors). \n\nPending: A node is being started by the Ray cluster launcher. The node is unavailable now because it is being provisioned and initialized.","fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisBorderShow":false,"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":0,"barWidthFactor":0.6,"drawStyle":"line","fillOpacity":100,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"insertNulls":false,"lineInterpolation":"linear","lineWidth":1,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"never","spanNulls":true,"stacking":{"group":"A","mode":"normal"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"min":0,"thresholds":{"mode":"absolute","steps":[{"color":"green"},{"color":"red","value":80}]},"unit":"nodes"},"overrides":[{"matcher":{"id":"byName","options":"MAX"},"properties":[{"id":"color","value":{"fixedColor":"#1F60C4","mode":"fixed"}},{"id":"custom.fillOpacity","value":0},{"id":"custom.stacking","value":{"group":"A","mode":"none"}},{"id":"custom.lineStyle","value":{"dash":[10,10],"fill":"dash"}}]},{"matcher":{"id":"byName","options":"MAX + PENDING"},"properties":[{"id":"color","value":{"fixedColor":"#777777","mode":"fixed"}},{"id":"custom.fillOpacity","value":0},{"id":"custom.stacking","value":{"group":"A","mode":"none"}},{"id":"custom.lineStyle","value":{"dash":[10,10],"fill":"dash"}}]},{"matcher":{"id":"byValue","options":{"op":"gte","reducer":"allIsZero","value":0}},"properties":[{"id":"custom.hideFrom","value":{"legend":true,"tooltip":true,"viz":false}}]}]},"gridPos":{"h":8,"w":12,"x":12,"y":72},"id":24,"options":{"alertThreshold":true,"legend":{"calcs":["lastNotNull"],"displayMode":"table","placement":"bottom","showLegend":true},"tooltip":{"hideZeros":false,"mode":"multi","sort":"none"}},"pluginVersion":"12.0.0","targets":[{"datasource":{"uid":"${datasource}"},"editorMode":"code","exemplar":true,"expr":"sum(ray_cluster_active_nodes{SessionName=~\"$SessionName\",ray_io_cluster=~\"$Cluster\"}) - sum(ray_node_failure_total{SessionName=~\"$SessionName\",ray_io_cluster=~\"$Cluster\",})","interval":"","legendFormat":"Active Nodes","queryType":"randomWalk","range":true,"refId":"A"},{"datasource":{"uid":"${datasource}"},"editorMode":"code","exemplar":true,"expr":"sum(ray_node_failure_total{SessionName=~\"$SessionName\",ray_io_cluster=~\"$Cluster\",})","interval":"","legendFormat":"Failed Nodes","queryType":"randomWalk","range":true,"refId":"B"}],"title":"Node Count","type":"timeseries"},{"datasource":{"uid":"${datasource}"},"description":"Aggregated utilization of all physical resources (CPU, GPU, memory, disk, or etc.) across the cluster.","fieldConfig":{"defaults":{"color":{"mode":"palette-classic"},"custom":{"axisBorderShow":false,"axisCenteredZero":false,"axisColorMode":"text","axisLabel":"","axisPlacement":"auto","barAlignment":0,"barWidthFactor":0.6,"drawStyle":"line","fillOpacity":0,"gradientMode":"none","hideFrom":{"legend":false,"tooltip":false,"viz":false},"insertNulls":false,"lineInterpolation":"linear","lineWidth":1,"pointSize":5,"scaleDistribution":{"type":"linear"},"showPoints":"never","spanNulls":false,"stacking":{"group":"A","mode":"none"},"thresholdsStyle":{"mode":"off"}},"mappings":[],"min":0,"thresholds":{"mode":"absolute","steps":[{"color":"green"},{"color":"red","value":80}]},"unit":"%"},"overrides":[{"matcher":{"id":"byName","options":"MAX"},"properties":[{"id":"color","value":{"fixedColor":"#1F60C4","mode":"fixed"}},{"id":"custom.fillOpacity","value":0},{"id":"custom.stacking","value":{"group":"A","mode":"none"}},{"id":"custom.lineStyle","value":{"dash":[10,10],"fill":"dash"}}]},{"matcher":{"id":"byName","options":"MAX + PENDING"},"properties":[{"id":"color","value":{"fixedColor":"#777777","mode":"fixed"}},{"id":"custom.fillOpacity","value":0},{"id":"custom.stacking","value":{"group":"A","mode":"none"}},{"id":"custom.lineStyle","value":{"dash":[10,10],"fill":"dash"}}]},{"matcher":{"id":"byValue","options":{"op":"gte","reducer":"allIsZero","value":0}},"properties":[{"id":"custom.hideFrom","value":{"legend":true,"tooltip":true,"viz":false}}]}]},"gridPos":{"h":8,"w":12,"x":0,"y":80},"id":41,"options":{"alertThreshold":true,"legend":{"calcs":["lastNotNull"],"displayMode":"table","placement":"bottom","showLegend":true},"tooltip":{"hideZeros":false,"mode":"multi","sort":"none"}},"pluginVersion":"12.0.0","targets":[{"datasource":{"uid":"${datasource}"},"exemplar":true,"expr":"avg(ray_node_cpu_utilization{instance=~\"$Instance\",SessionName=~\"$SessionName\",ray_io_cluster=~\"$Cluster\",})","interval":"","legendFormat":"CPU (physical)","queryType":"randomWalk","refId":"A"},{"datasource":{"uid":"${datasource}"},"exemplar":true,"expr":"sum(ray_node_gpus_utilization{instance=~\"$Instance\",SessionName=~\"$SessionName\",ray_io_cluster=~\"$Cluster\",}) / on() (sum(autoscaler_cluster_resources{resource=\"GPU\",instance=~\"$Instance\",SessionName=~\"$SessionName\",ray_io_cluster=~\"$Cluster\",}) or vector(0))","interval":"","legendFormat":"GPU (physical)","queryType":"randomWalk","refId":"B"},{"datasource":{"uid":"${datasource}"},"exemplar":true,"expr":"sum(ray_node_mem_used{instance=~\"$Instance\",SessionName=~\"$SessionName\",ray_io_cluster=~\"$Cluster\",}) / on() (sum(ray_node_mem_total{instance=~\"$Instance\",SessionName=~\"$SessionName\",ray_io_cluster=~\"$Cluster\",})) * 100","interval":"","legendFormat":"Memory (RAM)","queryType":"randomWalk","refId":"C"},{"datasource":{"uid":"${datasource}"},"exemplar":true,"expr":"sum(ray_node_gram_used{instance=~\"$Instance\",SessionName=~\"$SessionName\",ray_io_cluster=~\"$Cluster\",}) / on() (sum(ray_node_gram_available{instance=~\"$Instance\",SessionName=~\"$SessionName\",ray_io_cluster=~\"$Cluster\",}) + sum(ray_node_gram_used{instance=~\"$Instance\",SessionName=~\"$SessionName\",ray_io_cluster=~\"$Cluster\",})) * 100","interval":"","legendFormat":"GRAM","queryType":"randomWalk","refId":"D"},{"datasource":{"uid":"${datasource}"},"exemplar":true,"expr":"sum(ray_object_store_memory{instance=~\"$Instance\",SessionName=~\"$SessionName\",ray_io_cluster=~\"$Cluster\",}) / on() sum(ray_resources{Name=\"object_store_memory\",instance=~\"$Instance\",SessionName=~\"$SessionName\",ray_io_cluster=~\"$Cluster\",}) * 100","interval":"","legendFormat":"Object Store Memory","queryType":"randomWalk","refId":"E"},{"datasource":{"uid":"${datasource}"},"exemplar":true,"expr":"sum(ray_node_disk_usage{instance=~\"$Instance\",SessionName=~\"$SessionName\",ray_io_cluster=~\"$Cluster\",}) / on() (sum(ray_node_disk_free{instance=~\"$Instance\",SessionName=~\"$SessionName\",ray_io_cluster=~\"$Cluster\",}) + sum(ray_node_disk_usage{instance=~\"$Instance\",SessionName=~\"$SessionName\",ray_io_cluster=~\"$Cluster\",})) * 100","interval":"","legendFormat":"Disk","queryType":"randomWalk","refId":"F"}],"title":"Cluster Utilization","type":"timeseries"}],"preload":false,"refresh":"5s","schemaVersion":41,"tags":[],"templating":{"list":[{"current":{"text":"Prometheus","value":"prometheus"},"description":"Filter queries of a specific Prometheus type.","hide":2,"includeAll":false,"name":"datasource","options":[],"query":"prometheus","refresh":1,"regex":"","type":"datasource"},{"allValue":".+","current":{"text":"All","value":"$__all"},"datasource":"${datasource}","definition":"label_values(ray_node_network_receive_speed{}, SessionName)","description":"Filter queries to specific ray sessions.","includeAll":true,"name":"SessionName","options":[],"query":{"query":"label_values(ray_node_network_receive_speed{}, SessionName)","refId":"StandardVariableQuery"},"refresh":2,"regex":"","sort":2,"type":"query"},{"current":{"text":"All","value":"$__all"},"datasource":"${datasource}","definition":"label_values(ray_node_network_receive_speed{}, ray_io_cluster)","description":"Filter queries to specific Ray clusters for KubeRay. When ingesting metrics across multiple ray clusters, the ray_io_cluster label should be set per cluster. For KubeRay users, this is done automaticaly with Prometheus PodMonitor.","includeAll":true,"name":"Cluster","options":[],"query":{"query":"label_values(ray_node_network_receive_speed{}, ray_io_cluster)","refId":"StandardVariableQuery"},"refresh":2,"regex":"","sort":2,"type":"query"},{"current":{"text":".+","value":".+"},"hide":2,"name":"Instance","query":".+","skipUrlSync":true,"type":"constant"}]},"time":{"from":"now-30m","to":"now"},"timepicker":{},"timezone":"","title":"Ray Overview","uid":"6278c3cb-a486-48c7-b058-343077b1145c","version":14}
